From 7cdbfe34463768094fad7b83e21e68256ab22797 Mon Sep 17 00:00:00 2001
From: Kirill Kapranov <kirill.kapranov@compulab.co.il>
Date: Wed, 21 Apr 2021 22:54:22 +0300
Subject: [PATCH 3/3] Exclude panic when DRAM exceeds 32bit boundary

Signed-off-by: Kirill Kapranov <kirill.kapranov@compulab.co.il>
---
 core/arch/arm/mm/core_mmu_lpae.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/core/arch/arm/mm/core_mmu_lpae.c b/core/arch/arm/mm/core_mmu_lpae.c
index 13068536..a5b70da7 100644
--- a/core/arch/arm/mm/core_mmu_lpae.c
+++ b/core/arch/arm/mm/core_mmu_lpae.c
@@ -72,6 +72,7 @@
 #include <mm/core_memprot.h>
 #include <mm/pgt_cache.h>
 #include <string.h>
+#include <stdio.h>
 #include <trace.h>
 #include <types_ext.h>
 #include <util.h>
@@ -362,7 +363,9 @@ static void check_nsec_ddr_max_pa(void)
 
 	for (mem = phys_nsec_ddr_begin; mem < phys_nsec_ddr_end; mem++)
 		if (!core_mmu_check_end_pa(mem->addr, mem->size))
-			panic();
+		trace_printf(__func__, __LINE__, 1, 1,
+			"Memory sec %s @%lx[%lx] exceeds the 32bit boundary\n",
+			mem->name, mem->addr, mem->size);
 }
 
 #ifdef CFG_VIRTUALIZATION
-- 
2.17.1

