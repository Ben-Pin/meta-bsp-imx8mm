From 63f49548a40464a59e7a846f721a91c325cb6842 Mon Sep 17 00:00:00 2001
From: Kirill Kapranov <kirill.kapranov@compulab.co.il>
Date: Wed, 8 Feb 2023 21:31:33 +0200
Subject: [PATCH 84/84] dts-defconfig: Fix cpufreq sysfs attr disappearance

Signed-off-by: Kirill Kapranov <kirill.kapranov@compulab.co.il>
---
 arch/arm64/boot/dts/compulab/mcm-imx8m-mini.dtsi | 14 +++++++++++++-
 arch/arm64/boot/dts/compulab/ucm-imx8m-mini.dtsi | 14 +++++++++++++-
 arch/arm64/configs/cl-imx8m-mini_defconfig       |  1 +
 3 files changed, 27 insertions(+), 2 deletions(-)

diff --git a/arch/arm64/boot/dts/compulab/mcm-imx8m-mini.dtsi b/arch/arm64/boot/dts/compulab/mcm-imx8m-mini.dtsi
index 5fb3d405e724..66b6007cdc3e 100644
--- a/arch/arm64/boot/dts/compulab/mcm-imx8m-mini.dtsi
+++ b/arch/arm64/boot/dts/compulab/mcm-imx8m-mini.dtsi
@@ -692,7 +692,19 @@
 };
 
 &A53_0 {
-	arm-supply = <&buck2_reg>;
+	cpu-supply = <&buck2_reg>;
+};
+
+&A53_1 {
+	cpu-supply = <&buck2_reg>;
+};
+
+&A53_2 {
+	cpu-supply = <&buck2_reg>;
+};
+
+&A53_3 {
+	cpu-supply = <&buck2_reg>;
 };
 
 &gpu {
diff --git a/arch/arm64/boot/dts/compulab/ucm-imx8m-mini.dtsi b/arch/arm64/boot/dts/compulab/ucm-imx8m-mini.dtsi
index e67a55e44325..60479e5e2b04 100644
--- a/arch/arm64/boot/dts/compulab/ucm-imx8m-mini.dtsi
+++ b/arch/arm64/boot/dts/compulab/ucm-imx8m-mini.dtsi
@@ -243,7 +243,19 @@
 };
 
 &A53_0 {
-	arm-supply = <&buck2_reg>;
+	cpu-supply = <&buck2_reg>;
+};
+
+&A53_1 {
+	cpu-supply = <&buck2_reg>;
+};
+
+&A53_2 {
+	cpu-supply = <&buck2_reg>;
+};
+
+&A53_3 {
+	cpu-supply = <&buck2_reg>;
 };
 
 &wdog1 {
diff --git a/arch/arm64/configs/cl-imx8m-mini_defconfig b/arch/arm64/configs/cl-imx8m-mini_defconfig
index 8ef349c52aac..3e293e13b189 100644
--- a/arch/arm64/configs/cl-imx8m-mini_defconfig
+++ b/arch/arm64/configs/cl-imx8m-mini_defconfig
@@ -455,6 +455,7 @@ CONFIG_MFD_PCA9450=y
 CONFIG_REGULATOR=y
 CONFIG_REGULATOR_DEBUG=y
 CONFIG_REGULATOR_FIXED_VOLTAGE=y
+CONFIG_REGULATOR_BD718XX=y
 CONFIG_MEDIA_SUPPORT=y
 CONFIG_MEDIA_CAMERA_SUPPORT=y
 CONFIG_MEDIA_CONTROLLER=y
-- 
2.17.1

